\section{Об орграфах}

	Ранее мы ничего не говорили про ориентацию графов. Пришло время задеть эту насущную тему. 
	Сейчас мы займёмся вплотную изучением ориентированных графов.
	
\mysubsection{Базовые понятия орграфов}	
	
\begin{definition}
	Будем говорить, что ребро $e$, соединяющее вершины $a$ и $b$, имеет \emph{ориентацию}, подразумевая, 
	что отображение $I$ ставит этому ребру в соответствие упорядоченную пару $(a, b)$ или $(b, a)$. 
	В таком случае ребро также называют \emph{ориентированным}.
\end{definition}

\begin{definition}
	\emph{Орграф}~---~граф, состоящий из ориентированных ребер.
\end{definition}

\begin{definition}
	\emph{Простой орграф}~---~граф, в котором нет петель и кратных упорядоченных рёбер.
\end{definition}

\begin{example}[Омельченко А. В. <<Теория графов>>]
	Сколько различных ориентированных графов можно получить из одного и того же простого графа $G(V, E)$ ориентацией его рёбер?
	
	\emph{Решение.} Каждое ребро может быть ориентировано в двух различных направлениях. 
	Поэтому по правилу умножения получаем, что всего вариантов: $2^{|E|}$.
\end{example}


	Заметим, что промежуточного звена между ориентированными и неориентированными графами нет, так как если 
	в любом графе есть хотя бы одно ориентированное ребро, то можно все остальные ребра заменить на два 
	ориентированных противонаправленных ребра и получить орграф, который будет в некотором смысле <<изоморфен>> исходному.
	
	Говоря об изоморфизме орграфов, нельзя уже проверять только наличие и кратность ребер, потому что важно и направление ребер.

\begin{definition}
	Граф $Y$, полученный из неориентированного графа $G$ путём замены всех рёбер на ориентированные их аналоги, 
	называется \emph{ориентацией графа $G$}.
\end{definition}	

\begin{example}
	Сумасшедший король хочет ввести на дорогах своего королевства одностороннее движение так, чтобы выехав 
	из одного города, уже будет нельзя в него вернуться. Удастся ли ему осуществить свою затею?
	
	\emph{Решение.} Рассмотрим сначала частный случай, а именно: полный граф. В таком случае королю удастся 
	осуществить затею, например, следующим образом: выстроим города в ряд и будем все дороги ориентировать слева-направо.
	
	Теперь заметим, что если бы мы имели неполный граф, то это был бы подграф полного. Следовательно, опять же 
	расположим их в ряд и будем все ребра ориентировать слева-направо. В итоге, выходя из какого-то города мы 
	всегда будем попадать в гороод правее него, а значит, никогда не сможем вернуться обратно.
\end{example}

	Рассмотрим некоторые утверждения и понятия, которые мы раньше вводили, но уже на примере орграфа.
	
	Для начала заметим, что так как у нас все рёбра имеют направления, то мы не можем говорить просто про 
	инцидентные рёбра: важно ещё входя они или выходят из вершины.
	
\begin{definition}
	Число рёбер, выходящих из вершины $a$, называется \emph{исходящей степенью вершины} и обозначается $outdeg (a)$. 
	Число рёбер, входящих в вершину $a$, называется \emph{входящей степенью вершины} и обозначается $indeg (a)$.
\end{definition}

\begin{definition}
	Будем говорить, что вершина $b$ \emph{смежна} с вершиной $a$, если есть ребро $(a, b)$, 
	то есть из вершины $a$ можно добраться по ребру до вершины $b$.
\end{definition}

	Можно сформулировать аналог леммы о рукопожатиях.
	
\begin{lemma}[о взятках]
	В любом орграфе имеет место равенство
	$$\sum_i outdeg (x_i) = |E| = \sum_i indeg (x_i).$$
\end{lemma}

	В случае ориентированных графов очень сложно уйти от понятий эвивалентности, так что мы этого не 
	будем делать и сделаем небольшую остановку, чтобы разобраться с ними. 
	
\mysubsection{Отношение эквивалентности}
	
	Для начала рассмотрим произвольное множество $M$. Будем говорить, что на этом множестве задано \emph{бинарное отношение}, 
	если для любой упорядоченной пары $(a, b)$ поставлена в соответствие единица или ноль. Другими словами, мы говорим об 
	отношении, как о правиле, по которому мы объединяем некоторые элементы. Прилагательное <<бинарное>> в этом случае означает, 
	что мы имеем дело с двумя элементами, хотя в общем случае бывают правила, которые задают отношение между 
	большим количеством элементов множества.
	
	Далее есть три свойства отоношения, которые нам понадобятся. Первое из них~---~\emph{рефлексивность}~---~заключается в том, 
	что для пар $(a, a)$ в соответствие должна быть поставлена единица. Суть второго~---~\emph{симметричности}~---~в том, что паре $(a, b)$ 
	поставлена в соответствие единица тогда и только тогда, когда и паре $(b, a)$ поставлена в соответствие единица. 
	Третье из них~---~\emph{транзитивность}~---~уточняет отношение для трёх элементов, а точнее, оно гласит, 
	что если парам $(a, b)$ и $(b, c)$ поставлена в соответствие единица, то и паре $(a, c)$ поставлена в соответствие единица.
	
	Будем говорить, что бинарное отношение является \emph{отношением эквивалентности}, 
	если оно удовлетворяет всем трём свойствам, описанным в предыдущем абзаце.
	
	Например, равенство является отношением эквивалентности. Кроме того, легко проверить, что связность в графе тоже будет таким отношением. 
	
	На этом мучений читателей, впервые столкнувшихся с отношением эквивалентности, не закончены. 
	Надо заметить, что отношение эквивалентности разбивает всё множество на \emph{классы эквивалентности}, 
	внутри которых все объекты эквивалентны. Таким образом, мы можем говорить о \emph{фактормножестве}, 
	суть которого заключается, что мы всему классу эквивалентности ставим в соответствие единственный элемент, 
	то есть буквально отождествляем все эквивалентные элементы.
	
	Используя всю терминологию, связанную с отношением эквивалентности, мы можем сказать, что в 
	неориентированных графах число компонент связности есть ни что иное, как количество классов эквивалентности по отношению связности.

	Теперь вернёмся к орграфам. 	
	
\mysubsection{Связность в орграфах. Конденсат}

\begin{definition}
	Будем говорить, что вершина $a$ \emph{достижима} из вершины $b$, если есть путь, начинающийся в вершине $b$ и 
	заканчивающийся в вершине $a$.	
\end{definition}	 
	
\begin{definition}
	Вершины $c$ и $d$ орграфа называются \emph{связанными}, если существует хотя бы один путь из $c$ в $d$ и 
	есть хотя бы один путь из $d$ в $c$.
\end{definition}	 

	Заметим, что при таком определении связность остаётся отношением экививалентности, но в этом случае 
	классы эквивалентности уже называют \emph{сильными компонентами связности}.
	
\begin{definition}
	Орграф называется \emph{сильно связным}, если он состоит из одной сильной компоненты связности. 
\end{definition}

	В случае, если нас интересует связность неориентированного графа, ориентацией которого является исходный граф, 
	то можно пользоваться следующим понятием.

\begin{definition}
	Орграф $D$ называется \emph{слабо связным}, если он не является сильно связным, но граф $G$, ориентацией которого является $D$, связен.
\end{definition}

	Как можно заметить, фактор-граф по отношению связности в случае неориентированного графа является всегда 
	набором изолированных точек. Однако при переходе к орграфам всё резко меняется.

\begin{definition}
	Фактор-граф графа $G$ по отношению связности называется \emph{конденсатом} и обозначается $C(G)$.
\end{definition}

\begin{theorem}
	Конденсат любого орграфа $D$~---~ациклический орграф (DAG~---~directed acyclic graph).
	
	\emph{Доказательство.} Допустим, что в нём есть цикл. Тогда между любыми двумя вершинами $C(D)$ в этом цикле 
	есть путь в обе стороны, то есть они связаны, следовательно, должны быть в одной компоненте сильной связности. Противоречие.
\end{theorem}

	Чтобы получить конденсат графа нужно воспользоваться топологической сортировкой. Ее мы будем разбирать подробно 
	уже в соответствующем разделе. Заметим, что один из приемов, которым при этом мы будем пользоавться, 
	заключается в инвертировании ребер графа, то есть когда мы все ребра $(a, b)$ меняем на ребра $(b, a)$.

	Конденсат орграфа занимает центральное место в теории ориентированных графов. С одной стороны, его достаточно легко 
	найти в произвольном графе, а алгоритмы, которые помогают это сделать, требуют мало времени и памяти для работы. 
	С другой стороны, ориентированные ациклические графы имеют широкое практическое применение. 
	
	Например, предположим, что вам надо составить свой курс. У вас есть набор тем, которые ссылаются друг на друга. 
	Построив конденсат графа, в котором вершинами будут темы, а рёбрами будут ссылки, вы сможете понять, какие темы 
	и в каком порядке надо давать.

	Возвращаясь немного назад, скажем пару слов о турнирах.
	
\mysubsection{Транзитивные турниры}	
	
\begin{definition}
	\emph{Турнир $T$}~---~орграф, полученный произвольной ориентацией полного графа $K_n$.
\end{definition}

	Граф $T$ можно встретить при решении задач на круговые турниры, в которых каждый участник играет с каждым и 
	при этом ничьи не бывает. В этом случае ребро обычно направляют от победившего к проигравшему.
	
\begin{example}
	Был проведен круговой турнир по шахматам. Ничьих не было. Известно, что если игрок $A$ выиграл у игрока $B$, 
	а игрок $B$ выиграл у игрока $C$, то $A$ выиграл у игрока $C$. Докажите, что есть игрок, выигравший у всех.

\begin{proof}	
	Рассмотрим игрока $A$, который выиграл в наибольшем числе матчей. Допустим противное: есть игрок $B$, 
	у которого он не выиграл. Тогда игрок $B$ выиграл у игрока $A$, так и у всех игроков, которых обыграл последний. 
	Следовательно, игрок $B$ выиграл у большего числа игроков. Противоречие.
\end{proof}
\end{example}

\begin{definition}
	Турнир $T$ называется \emph{транзитивным}, если из условий $(a, b) \in E(T)$, $(b, c) \in E(T)$ следует, что $(a, c) \in E(T)$.
\end{definition}

\begin{statement}
	Турнир является транзитивным, когда он совпадает со свои конденсатом.
	
	\emph{Доказательство.} Это условие эквивалентно тому, что в графе нет циклов. Следовательно, так как все рёбра есть, 
	а циклов нет, то при существовании рёбер $(a, b)$ и $(b, c)$ однозначно восстанавливается ребро между 
	вершинами $a$ и $c$~---~$e = (a, c)$. По определению этот турнир будет транзитивным. ч.т.д.
\end{statement}

\begin{consequence}
	В нетранзитивном турнире есть ориентированный цикл длины 3.
\end{consequence}

\begin{consequence}
	Конденсат турнира всегда является транзитивным турниром.
	
	\emph{Доказательство.} Заметим, что $C(C(T)) = C(T)$.
\end{consequence}

$ $
\newline
	Мы познакомились ближе с орграфами. Узнали про аналогичные неориентированным графам утверждения, термины. 
	А также забежали немного вперёд по программе и поговорили об отношении эквивалентности.

\mysubsection{Задачи}

\begin{exersize}[Бабичева Т.С., Бабичев С.Л., Жогов А. А., Яковлев И.В. <<Пособие по олимпиадной математике. Уровень А1>>]
	По кругу записаны $7$ натуральных чисел. Известно, что в каждой паре соседних чисел одно делится на другое. 
	Докажите, что найдется пара и несоседних чисел с таким же свойством.
\end{exersize}

\begin{exersize}[Генкин С.А., Итенберг И.В., Фомин Д.В. <<Ленинградские математические кружки>>]
	В некоторой стране есть столица и еще $100$ городов. Некоторые города (в том числе и столица) соединены 
	дорогами с односторонним движением. Из каждого нестоличного города выходит $20$ дорог, и в каждый 
	такой город входит $21$ дорога. Докажите, что в столицу нельзя проехать ни из одного города.	
\end{exersize}

\begin{exersize}
	Докажите, что на рёбрах любого связного графа можно расставить стрелки, что найдется вершина, из которой 
	можно было бы добраться по стрелкам в любую другую.
\end{exersize}

\begin{exersize}[Канель-Белов А.Я., Ковальджи А.К. Как решают нестандартные задачи]
	В тридевятом царстве каждые два города соединены дорогой с односторонним движением. Докажите, что существует город, 
	из которого сожно проехать в любой другой не более чем по двум дорогам.
\end{exersize}

\begin{exersize}[Бабичева Т.С., Бабичев С.Л., Жогов А. А., Яковлев И.В. <<Пособие по олимпиадной математике. Уровень А1>>]
	Каждый член партии доверяет пяти однопартийцам, но никакие двое не доверяют друг другу. 
	При каком минимальном размере партии такое возможно?
\end{exersize}

\begin{exersize}[Бабичева Т.С., Бабичев С.Л., Жогов А. А., Яковлев И.В. <<Пособие по олимпиадной математике. Уровень А1>>]
	На сторонах некоторого многоугольника расставлены стрелки. 
	Докажите, что число вершин, в которые входят 
	две стрелки, равно числу вершин, из которых выходят две стрелки.
\end{exersize}

\begin{exersize}[Омельченко А. В. <<Теория графов>>]
	Какое максимальное количество ребер может быть в простом
	слабо связном ориентированном графе на $n$ вершинах, 
	не являющемся сильно связным?
\end{exersize}

\begin{exersize}[Генкин С.А., Итенберг И.В., Фомин Д.В. <<Ленинградские математические кружки>>]
	Докажите, что на ребрах связного графа можно так расставить стрелки, чтобы из некоторой вершины можно 
	было бы добраться по стрелкам до любой другой.
\end{exersize}

\begin{exersize}
	 В некоторой стране каждый город соединен с каждым дорогой с односторонним движением. 
	 a) Докажите, что найдется город, из которого можно попасть в любой другой. 
	 b) Докажите, что можно поменять направление движения на одной дороге так, что из любого города можно будет попасть в любой другой.
\end{exersize}

\begin{exersize}[Омельченко А. В. <<Теория графов>>]
	Докажите, что в случае нечетных $n$ существует турнир $T$, в котором для любой вершины $x$ выполняется равенство
	$$outdeg(x) = indeg(x).$$
\end{exersize}

\begin{exersize}[Омельченко А. В. <<Теория графов>>]
	Докажите, что для произвольного турнира $T$ справедливо равенство
	$$\sum_{x \in V(T)} outdeg(x)^2 = \sum_{x \in V(T)} indeg(x)^2.$$
\end{exersize}

\mysubsection{Дополнительные задачи}

\begin{exersize}[Федоров Р. М., Канель-Белов А. Я., Ковальджи А. К., Ященко И. В. <<Московские математические олимпиады>>]
	В стране несколько городов, соединенных дорогами с односторонним и двусторонним движением. 
	Известно, что из каждого города в любой другой можно проехать ровно одним путем, не проходящим 
	два раза через один и тот же город. Докажите, что страну можно разделить на три губернии так, 
	чтобы ни одна дорога не соединяла два города из одной губернии.
\end{exersize}	

\begin{exersize}[Федоров Р. М., Канель-Белов А. Я., Ковальджи А. К., Ященко И. В. <<Московские математические олимпиады>>]
	По кругу расставлено несколько коробочек. В каждой из них может лежать один или несколько шариков (или она может быть пустой). 
	За один ход  разрешается взять все шарики из любой коробочки и разложить их, двигаясь по часовой стрелке, 
	начиная со следующей коробочки, кладя в каждую коробочку по одному шарику.
	
	а) Докажите, что если на каждом следующем ходе шарики берут из той коробочки, 
	в которую попал последний шарик на предыдущем ходе, то в какой-то момент повторится начальное размещение шариков.
	
	б) Докажите, что за несколько ходов из любого начального размещения шариков по коробочкам можно получить любое другое.
\end{exersize}	


\begin{exersize}[Агаханов Н.Х., Богданов И.И., Кожевников П.А., Подлипский О.К., Терешин Д.А. <<Всероссийские олимпиады школьников по математике 1993~---~2009: Заключительные этапы>>]
	В некотором государстве было $2004$ города, соединенных дорогами так, что из любого города 
	можно было добраться до любого другого. Известно, что при запрещенном проезде по любой из дорог, 
	по-прежнему из любого города можно было бы добраться до любого другого. Министр транспорта и министр 
	внутренних дел по очереди вводят на дорогах, пока есть возможность, одностороннее движение (на одной дороге за ход), 
	причем министр, после хода которого из какого-либо города стало невозможно добраться до какого-либо другого, 
	немедленно уходит в отставку. Первым ходит министр транспорта. 
	Может ли кто-либо из министров добиться отставки другого независимо от его игры?
\end{exersize}	

\begin{exersize}[Агаханов Н.Х., Богданов И.И., Кожевников П.А., Подлипский О.К., Терешин Д.А. <<Всероссийские олимпиады школьников по математике 1993~---~2009: Заключительные этапы>>]
	В стране $1001$ город, любые два города соединены дорогой с односторонним движением. 
	Из каждого города выходит ровно $500$ дорог, в каждый город входит ровно $500$ дорог. 
	От страны отделилась независимая республика.ю в которую вошли $668$ городов. 
	Докажите, что из любого города этой республики можно доехать до любого другого ее города, не выезжая за пределы республики.
\end{exersize}	 